

<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Time Step Execution &#8212; Home</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/cyclus.css?v=a0e5ed17" />
    <link rel="stylesheet" type="text/css" href="../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="../_static/documentation_options.js?v=8cf7d53e"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="icon" href="../_static/big_c.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Resources" href="resources.html" />
    <link rel="prev" title="Testing and Debugging Archetypes" href="testing.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1"><script type="text/javascript">
var ga_enabled = !$.cookie('disable-ga');
if(ga_enabled){
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12222727-2']);
  _gaq.push(['_setCookiePath', '/']);
  _gaq.push(['_setDetectFlash', false]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
}
</script>
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="resources.html" title="Resources"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="testing.html" title="Testing and Debugging Archetypes"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">Home</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U"><span style="font-variant:small-caps;">Cyclus</span> Archetype Developer Guide</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Time Step Execution</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="time-step-execution">
<h1>Time Step Execution<a class="headerlink" href="#time-step-execution" title="Link to this heading">¶</a></h1>
<p>A <span style="font-variant:small-caps;">Cyclus</span> simulation is composed of discrete time steps, and each time step is
subdivided into phases. Phases come in two flavors: kernel phases and agent
phases. Kernel phases include actions that have either been registered to occur
with the <span style="font-variant:small-caps;">Cyclus</span> kernel (e.g., building a new facility agent) or are driven by
the <span style="font-variant:small-caps;">Cyclus</span> kernel (e.g., the Resource Exchange). Agent phases are points
within a given time step that allow agents to query the current simulation
environment and perform any agent-specific actions, such as scheduling a new
agent to be built or scheduling a current agent to be decommissioned.</p>
<p>The list of phases in order is:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#build"><span class="std std-ref">Build Phase</span></a> (kernel)</p></li>
<li><p><a class="reference internal" href="#tick"><span class="std std-ref">Tick Phase</span></a> (agent)</p></li>
<li><p><a class="reference internal" href="#exchng"><span class="std std-ref">Dynamic Resource Exchange Phase</span></a> (kernel)</p></li>
<li><p><a class="reference internal" href="#tock"><span class="std std-ref">Tock Phase</span></a> (agent)</p></li>
<li><p><a class="reference internal" href="#decom"><span class="std std-ref">Decommission Phase</span></a> (kernel)</p></li>
</ul>
<p>Agent phases are invoked using a method call of the same name, e.g.,</p>
<p><strong>C++:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">MyAgent::Tick</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// perform agent-phase Tick&#39;s work</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Python:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tick</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># perform agent-phase tick&#39;s work, no return value</span>
</pre></div>
</div>
<p>Importantly, the order in which agents’ agent-phase methods are invoked is <em>not
guaranteed</em>. In other words, the execution of any given phase is conceptually
occurring <em>simultaneously among agents</em>.</p>
<p>The duration of a time step can be set to custom values by users when running
simulations.  Archetypes must be coded with this in mind.  One easy method for
supporting arbitrary time step duration is to make all time-related quantities
and configuration in the archetype operate on a per-time-step basis (e.g.
reactor cycle length measured in time steps instead of days or months).  If
archetypes do have constraints on the time step duration (e.g. they only
support approximately 1-month time steps), then they should throw an
exception as early as possible (i.e. in their constructor).  The time step
duration can be queried from an the simulation context:</p>
<p><strong>C++:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">MyAgent::Tick</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">discharge_qty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">discharge_rate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">context</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">dt</span><span class="p">();</span>
<span class="w">    </span><span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Python:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tick</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">discharge_qty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discharge_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">dt</span>
    <span class="o">...</span>
</pre></div>
</div>
<section id="build-phase">
<span id="build"></span><h2>Build Phase<a class="headerlink" href="#build-phase" title="Link to this heading">¶</a></h2>
<p>In the Build phase, agents that have been scheduled to be built are entered into
the simulation. The entry process includes creating the agent (cloning from a
<a class="reference internal" href="../basics/glossary.html#term-prototype"><span class="xref std std-term">prototype</span></a>), connecting it with the <a class="reference internal" href="../basics/glossary.html#term-parent-agent"><span class="xref std std-term">parent agent</span></a> that originally
registered the build, and calling its <code class="docutils literal notranslate"><span class="pre">Build</span></code> virtual member function. The
parent is informed that a new child has been built via the <code class="docutils literal notranslate"><span class="pre">cyclus::Agent</span></code>’s
<code class="docutils literal notranslate"><span class="pre">BuildNotify</span></code> member function.</p>
<p>Future builds can be scheduled by any <a class="reference internal" href="../basics/glossary.html#term-agent"><span class="xref std std-term">agent</span></a> using the
<code class="docutils literal notranslate"><span class="pre">cyclus::Context</span></code>’s <code class="docutils literal notranslate"><span class="pre">SchedBuild</span></code> member function. A build cannot be
scheduled for the current time step, but a build can be scheduled for any
future time step.</p>
</section>
<section id="tick-phase">
<span id="tick"></span><h2>Tick Phase<a class="headerlink" href="#tick-phase" title="Link to this heading">¶</a></h2>
<p>The Tick phase allows agents to analyze the current status of the simulation
(e.g., the current number of built facilities) and perform any actions they so
choose <em>before</em> the execution of the Resource Exchange. For example, an agent
could schedule to build a new child agent or perform some process on its
available inventory of resources.</p>
</section>
<section id="dynamic-resource-exchange-phase">
<span id="exchng"></span><h2>Dynamic Resource Exchange Phase<a class="headerlink" href="#dynamic-resource-exchange-phase" title="Link to this heading">¶</a></h2>
<p>The Dynamic Resource Exchange phase is a <a class="reference internal" href="../basics/glossary.html#term-kernel-phase"><span class="xref std std-term">kernel phase</span></a> in which the
supply and demand of resources is queried, solved, and the trading thereof is
executed. The supply and demand of each concrete resource type
(e.g. <code class="docutils literal notranslate"><span class="pre">cyclus::Material</span></code> and <code class="docutils literal notranslate"><span class="pre">cyclus::Product</span></code>) are solved for
independently. A full discussion of this phase is provided in <a class="reference internal" href="dre.html#dre"><span class="std std-ref">Dynamic Resource Exchange</span></a>.</p>
</section>
<section id="tock-phase">
<span id="tock"></span><h2>Tock Phase<a class="headerlink" href="#tock-phase" title="Link to this heading">¶</a></h2>
<p>The Tock phase allows agents to analyze the current status of the simulation
(e.g., the current number of built facilities) and perform any actions they so
choose <em>after</em> the execution of the Resource Exchange. For example, an agent
could schedule to decommission a child agent or perform some process on its
available inventory of resources.</p>
</section>
<section id="decommission-phase">
<span id="decom"></span><h2>Decommission Phase<a class="headerlink" href="#decommission-phase" title="Link to this heading">¶</a></h2>
<p>In the Decommission phase, agents that have been scheduled to be decommissioned
are removed from the simulation. The removal process includes informing the
<a class="reference internal" href="../basics/glossary.html#term-parent-agent"><span class="xref std std-term">parent agent</span></a> that one of its children is being decommissioned and
calling the child agent’s <code class="docutils literal notranslate"><span class="pre">Decommission</span></code> function. The parent is informed that
a child is being decommissioned via the <code class="docutils literal notranslate"><span class="pre">cyclus::Agent</span></code>’s <code class="docutils literal notranslate"><span class="pre">DecomNotify</span></code>
member function.</p>
<p>Future decommissions can be scheduled by any <a class="reference internal" href="../basics/glossary.html#term-agent"><span class="xref std std-term">agent</span></a> using the
<code class="docutils literal notranslate"><span class="pre">cyclus::Context</span></code>’s <code class="docutils literal notranslate"><span class="pre">SchedDecom</span></code> member function. A decommission can be
scheduled for the current time step or any future time step.</p>
<p>Decommissioning occurs at the end of a time step. Therefore, an agent with a lifetime
of 1 would be decommissioned on the same time step it was built. The lifetime of an
agent can be back calculated by <cite>1+exit_time-start_time</cite>.</p>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">¶</a></h2>
<p>For a more in depth (and historical) discussion, see <a class="reference external" href="http://fuelcycle.org/cep/cep20.html">CEP 20</a>.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../index.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Time Step Execution</a><ul>
<li><a class="reference internal" href="#build-phase">Build Phase</a></li>
<li><a class="reference internal" href="#tick-phase">Tick Phase</a></li>
<li><a class="reference internal" href="#dynamic-resource-exchange-phase">Dynamic Resource Exchange Phase</a></li>
<li><a class="reference internal" href="#tock-phase">Tock Phase</a></li>
<li><a class="reference internal" href="#decommission-phase">Decommission Phase</a></li>
<li><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="testing.html"
                          title="Previous page">&larr; Testing and Debugging Archetypes</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="resources.html"
                          title="Next page">&rarr; Resources</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="resources.html" title="Resources"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="testing.html" title="Testing and Debugging Archetypes"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">Home</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" ><span style="font-variant:small-caps;">Cyclus</span> Archetype Developer Guide</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Time Step Execution</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2012-2024, University of Wisconsin Computational Nuclear Engineering Research Group.
      Last updated on Apr 01, 2024.
    </div><script type="text/javascript">
    if(ga_enabled){
        document.write("<div class=\"footer\">This page uses <a href=\"http://analytics.google.com\">Google Analytics</a> to collect statistics. ");
        document.write("Click <button title=\"set cookie to disable analytics for this site\" class=\"link\" onclick=\"$.cookie('disable-ga', 'true', {expires: 3650, path: '/'}); window.location.reload(); return false; \">here</button> to disable analytics for this site.");
        document.write("</div>");
    }else{
        document.write("<div class=\"footer\">Google Analytics has been disabled. ");
        document.write("Click <button title=\"set cookie to re-enable analytics for this site\" class=\"link\" onclick=\"$.cookie('disable-ga', null, {path: '/'}); window.location.reload(); return false; \">here</button> to re-enable analytics for this site.");
    };
</script>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>